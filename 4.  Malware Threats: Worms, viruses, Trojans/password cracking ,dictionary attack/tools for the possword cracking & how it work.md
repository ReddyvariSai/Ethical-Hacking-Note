# Password Cracking Tools & How They Work

## **Popular Password Cracking Tools**

### 1. **Hashcat** (The "World's Fastest")
- **Type**: GPU-based cracking tool
- **Best For**: Professional/advanced users
- **Key Features**:
  - Supports 300+ hash algorithms
  - Uses GPU for extreme speed
  - Multiple attack modes
- **Attack Modes**:
  - `0` Straight (dictionary)
  - `3` Brute-force
  - `6` Hybrid (dict + mask)
  - `7` Hybrid (mask + dict)

**Basic Command Example:**
```bash
# Dictionary attack
hashcat -m 0 hashes.txt wordlist.txt

# Brute force (3 lowercase + 3 digits)
hashcat -m 0 -a 3 hashes.txt ?l?l?l?d?d?d

# Hybrid (dictionary + numbers)
hashcat -m 0 -a 6 hashes.txt wordlist.txt ?d?d?d
```

### 2. **John the Ripper** (The Classic)
- **Type**: CPU-based, versatile
- **Best For**: Beginners, multiple hash types
- **Key Features**:
  - Built-in wordlist mangling rules
  - Incremental mode (smart brute force)
  - Community-enhanced versions

**Basic Command Example:**
```bash
# Simple dictionary attack
john --wordlist=rockyou.txt hashes.txt

# With rules (modify words)
john --wordlist=passwords.txt --rules hashes.txt

# Show cracked passwords
john --show hashes.txt
```

### 3. **Hydra** (Online Attack Tool)
- **Type**: Network login cracker
- **Best For**: Live system attacks (FTP, SSH, HTTP forms)
- **Warning**: For authorized testing ONLY
- **Protocols**: 50+ (SSH, FTP, HTTP, SMB, etc.)

**Example SSH Attack:**
```bash
hydra -l admin -P passwords.txt ssh://192.168.1.100
```

### 4. **Aircrack-ng** (WiFi Cracking)
- **Type**: Wireless network security tool
- **For**: WEP/WPA/WPA2-PSK cracking
- **Process**: Capture handshake → Crack offline

### 5. **Ophcrack** (Windows Focus)
- **Type**: Rainbow table-based
- **Best For**: Windows password recovery
- **Uses**: Free rainbow tables for LM/NTLM hashes

---

## **How These Tools Actually Work**

### **Step-by-Step Process**

#### **Step 1: Obtain Password Hashes**
```python
# Example: How systems store passwords
import hashlib

password = "hello123"
salt = "x1y2z3"  # Random data added to password

# Hashing process (simplified)
hash_value = hashlib.md5((salt + password).encode()).hexdigest()
# Result: "5d41402abc4b2a76b9719d911017c592"
```

#### **Step 2: Identify Hash Type**
Tools automatically detect or require specifying:
```
MD5:    32 chars (e.g., 5d41402abc4b2a76b9719d911017c592)
SHA-1:  40 chars (e.g., 2aae6c35c94fcfb415dbe95f408b9ce91ee846ed)
SHA-256:64 chars
NTLM:   32 chars
bcrypt: 60 chars (starts with $2a$, $2b$, etc.)
```

#### **Step 3: Select Attack Mode**

---

## **Attack Modes in Detail**

### **1. Dictionary Attack Workflow**
```python
# Simplified algorithm
def dictionary_attack(target_hash, wordlist):
    with open(wordlist, 'r') as f:
        for word in f:
            # Hash each word
            hashed_word = hash_function(word.strip())
            
            # Compare with target
            if hashed_word == target_hash:
                return word.strip()  # Password found!
    return None  # Not found
```

**Common Wordlists:**
- `rockyou.txt` (14M passwords from 2009 breach)
- `SecLists/Passwords` (comprehensive collection)
- `crackstation.txt` (1.5B entries)
- Custom lists based on target (company name, sports teams, etc.)

### **2. Brute Force Attack Pattern**
```python
# Brute-force 3-character lowercase
chars = 'abcdefghijklmnopqrstuvwxyz'
for c1 in chars:
    for c2 in chars:
        for c3 in chars:
            attempt = c1 + c2 + c3
            # Hash and check...
            # 17,576 combinations for 3 chars
```

**Complexity Growth:**
- 4 lowercase: 456,976 combinations
- 8 mixed (upper+lower+digit): 218 trillion
- 12 full keyboard: 4.7×10²³ (impossible with current tech)

### **3. Rule-Based Attack (John/Word Mangling)**
Rules modify dictionary words:
```
# John's rule syntax examples
:          No change
l          Lowercase all letters
u          Uppercase all letters
c          Capitalize first, lower rest
$1         Add "1" at end
^!         Add "!" at beginning
sXY        Replace X with Y
```

**Example Transformations:**
```
password → Password (rule 'c')
password → password1 (rule '$1')
password → p@ssword (rule 'sa@')
```

### **4. Mask Attack (Smart Brute Force)**
Instead of ALL combos, target likely patterns:
```
?l = lowercase    ?u = uppercase
?d = digit        ?s = special
?h = hex lower    ?H = hex upper
```

**Common Masks:**
- `?u?l?l?l?d?d?d?d` (Capital + 3 letters + 4 digits)
- `?u?l?l?l?l?s?d?d` (Password!23)

---

## **Practical Example: Cracking WiFi with Aircrack-ng**

```bash
# Step 1: Put card in monitor mode
airmon-ng start wlan0

# Step 2: Capture handshake (4-way authentication)
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon

# Step 3: Deauthenticate client to force reconnection
aireplay-ng -0 10 -a AA:BB:CC:DD:EE:FF -c CLIENT:MAC wlan0mon

# Step 4: Crack captured handshake
aircrack-ng -w rockyou.txt capture-01.cap
```

---

## **Cracking with GPU vs CPU**

### **Hashcat with GPU Example**
```bash
# Using NVIDIA GPU (CUDA)
hashcat -m 2500 -d 1 capture.hccapx wordlist.txt

# -m 2500 = WPA/WPA2 mode
# -d 1    = Use GPU device 1
```

**Speed Comparison:**
| Hash Type | CPU (8-core) | GPU (RTX 4090) |
|-----------|--------------|----------------|
| MD5 | 100 MH/s | 100,000 MH/s |
| NTLM | 50 MH/s | 300,000 MH/s |
| WPA2 | 10 kH/s | 500 kH/s |
| bcrypt | 100 H/s | 20 kH/s |

*MH/s = million hashes per second*

---

## **Defense & Countermeasures**

### **For System Administrators:**

#### **1. Use Strong Password Policies**
```bash
# Linux pam_pwquality config
password requisite pam_pwquality.so retry=3
minlen=12 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1
```

#### **2. Implement Account Lockout**
```python
# Example pseudo-code
failed_attempts = 0
MAX_ATTEMPTS = 5

def check_login(username, password):
    if verify_password(username, password):
        failed_attempts = 0
        return True
    else:
        failed_attempts += 1
        if failed_attempts >= MAX_ATTEMPTS:
            lock_account(username, 30)  # Lock for 30 min
        return False
```

#### **3. Use Strong Hash Algorithms**
```python
# Good vs Bad Examples
# BAD (fast hashes, easy to crack):
hash = md5(password + salt)

# GOOD (slow, resource-intensive):
hash = bcrypt(password, cost=12)
# or
hash = argon2id(password, time_cost=3, memory_cost=65536)
```

#### **4. Add Pepper (Secret Salt)**
```python
# Pepper = application-wide secret
pepper = "my-secret-pepper-key-123"
hash = argon2id(password + salt + pepper)
# Even with database access, pepper remains secret
```

---

## **Ethical & Legal Considerations**

### **When It's Legal:**
- Testing **your own** systems
- Authorized penetration testing (written permission)
- Academic research
- Recovering **your own** forgotten passwords

### **When It's Illegal:**
- Accessing systems without authorization
- Testing others' systems without permission
- Distributing cracked credentials
- Bypassing copyright protection

**Always get written authorization!**

---

## **Quick Command Reference**

| Task | Hashcat | John the Ripper |
|------|---------|-----------------|
| Dictionary attack | `hashcat -a 0 -m TYPE` | `john --wordlist=FILE` |
| Brute force | `hashcat -a 3 ?l?l?l?d?d?d` | `john --incremental` |
| Show results | `hashcat --show` | `john --show` |
| Resume session | `hashcat --restore` | `john --restore` |
| Benchmark | `hashcat -b` | `john --test` |

---

## **Modern Reality**
Today's password cracking is largely about:
1. **Credential stuffing** (using leaked passwords elsewhere)
2. **Targeted attacks** (personalized wordlists from OSINT)
3. **Phishing** (easier than cracking)
4. **Exploiting password reset mechanisms**

The best defense: **long, unique passwords + 2FA everywhere**.

**Remember**: These tools are powerful. Use them responsibly, legally, and ethically—only on systems you own or have explicit written permission to test.
